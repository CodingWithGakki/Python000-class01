# 学习笔记

## 作业 1

使用 scrapy 爬取红楼梦 top100 评论

红楼梦词云效果如下：

![红楼梦词云效果](./book.png)

## 作业 2

使用 scrapy 爬取红楼梦 top100 评论和评价

```python
# 查看结果
print(df.head())
  star                                      short_content  sentiment
0   力荐  小时候顶讨厌读里面繁琐的细节描写，现在却读的特别有滋味，曹雪芹用尽所有心力描摹出的好时光，是...   0.999994
1   力荐  拥有的第一套名著.省了三个月零用钱买的.看过无数遍，每遍都看到新东西.有些部分可以背.不过我...   0.978196
2  NaN  翻来覆去读了不知道几百遍，在一个不相干的瞬间想起来这书，突然明白真的是在胡说八道。胡说胡听。...   0.999979
3   力荐                                  人生百态、婉转纠葛，不过一梦红楼。   0.990776
4   力荐                               人生厚度的增加会带来截然不同的阅读体验。   0.699125


# 分析平均值
print(df.sentiment.mean())
0.8560094923577926
```

评论和评价，通过 scrapy pipeline 保存到 mariadb：

```sh
drop database  IF EXISTS test;
create database test default charset 'utf8mb4';
grant all on test.* to 'test_user'@'%' identified by 'DB_PASSWORD';
flush privileges;

use test;
CREATE TABLE book (
    id bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    star varchar(16) DEFAULT NULL COMMENT '评价',
    short_content varchar(500) DEFAULT NULL COMMENT '短评',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=116 DEFAULT CHARSET=utf8mb4;

MariaDB [test]> desc book;
+---------------+---------------------+------+-----+---------+----------------+
| Field         | Type                | Null | Key | Default | Extra          |
+---------------+---------------------+------+-----+---------+----------------+
| id            | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| star          | varchar(16)         | YES  |     | NULL    |                |
| short_content | varchar(500)        | YES  |     | NULL    |                |
+---------------+---------------------+------+-----+---------+----------------+
3 rows in set (0.00 sec)



MariaDB [test]> select * from book limit 5;
+-----+--------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id  | star   | short_content                                                                                                                                                                                                                                                                                                                                                 |
+-----+--------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 116 | 力荐   | 小时候顶讨厌读里面繁琐的细节描写，现在却读的特别有滋味，曹雪芹用尽所有心力描摹出的好时光，是有根基的，鲜活的。 耐着性子把高鄂续写的部分读了三回，实在是忍无可忍，干脆就停在第八十回就很好了，毕竟“事若求全何所乐”，后四十回，不看也罢。                                                                                                                       |
| 117 | 力荐   | 拥有的第一套名著.省了三个月零用钱买的.看过无数遍，每遍都看到新东西.有些部分可以背.不过我的网名跟花袭人其实无关.哈.                                                                                                                                                                                                                                            |
| 118 | NULL   | 翻来覆去读了不知道几百遍，在一个不相干的瞬间想起来这书，突然明白真的是在胡说八道。胡说胡听。红学也好，考据也好，解空也好，悟道也好，名著也好，阴谋论也好，就都显得好笑了。                                                                                                                                                                                    |
| 119 | 力荐   | 人生百态、婉转纠葛，不过一梦红楼。                                                                                                                                                                                                                                                                                                                            |
| 120 | 力荐   | 人生厚度的增加会带来截然不同的阅读体验。                                                                                                                                                                                                                                                                                                                      |
+-----+--------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
5 rows in set (0.00 sec)

MariaDB [test]>
```
